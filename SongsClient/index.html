<!DOCTYPE html>
<html lang="en">

<head>
  <title>SongsHive</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="HTML5 website template">
  <meta name="keywords" content="global, template, html, sass, jquery">
  <meta name="author" content="Bucky Maler">
  <link rel="icon" href="./assets/img/logo.png">
  <link rel="stylesheet" href="assets/css/main.css">
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"
    integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous">
    </script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="./assets/js/ajaxCalls.js"></script>
  <script>
    const baseApi = 'https://localhost:7091/api/Users'
    $(document).ready(() => {
      let render = () => {
        if (localStorage["user"] != undefined) {
          $(".header--cta").html("Hello " + JSON.parse(localStorage["user"]).name);
          $("#loginLink").html('LOGOUT <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 150 118" style="enable-background:new 0 0 150 118;" xml:space="preserve"><g transform="translate(0.000000,118.000000) scale(0.100000,-0.100000)"><path d="M870,1167c-34-17-55-57-46-90c3-15,81-100,194-211l187-185l-565-1c-431,0-571-3-590-13c-55-28-64-94-18-137c21-20,33-20,597-20h575l-192-193C800,103,794,94,849,39c20-20,39-29,61-29c28,0,63,30,298,262c147,144,272,271,279,282c30,51,23,60-219,304C947,1180,926,1196,870,1167z" /></g></svg><span class="btn-background"></span>');
          $('#notMember').hide();
          $('#signUpLink').hide();
          $('.side-nav li:nth-child(6)').addClass('logout');
          $("#outBarLogin").html("Logout");
        }
        else {
          $(".header--cta").html("Hello Guest");
          $("#loginLink").html('Login <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 150 118" style="enable-background:new 0 0 150 118;" xml:space="preserve"><g transform="translate(0.000000,118.000000) scale(0.100000,-0.100000)"><path d="M870,1167c-34-17-55-57-46-90c3-15,81-100,194-211l187-185l-565-1c-431,0-571-3-590-13c-55-28-64-94-18-137c21-20,33-20,597-20h575l-192-193C800,103,794,94,849,39c20-20,39-29,61-29c28,0,63,30,298,262c147,144,272,271,279,282c30,51,23,60-219,304C947,1180,926,1196,870,1167z" /></g></svg><span class="btn-background"></span>');
          $('#notMember').show();
          $('#signUpLink').show();
          $('.side-nav li:nth-child(6)').removeClass('logout');
          $("#outBarLogin").html("Login");
        }
      }

      render();
      $('#signUpLink').click(function () {
        $("#mainFormDiv").html("");
        $("#mainFormDiv").append('<h2 id="formHeader">Sign up to enjoy new music</h2><form id="signUpForm" class="work-request"><div id="formDiv" class="work-request--information"><div class="information-name"><input id="regNameInp" type="text" spellcheck="false" pattern="[a-zA-Z]+" title="name must include only letters" required ><label for="name">Name</label></div><div class="information-email"><input id="regEmailInp" type="email" spellcheck="false" pattern="^([a-zA-Z\d.-]+)@([a-zA-Z\d-]+)\.([a-zA-Z]{2,8})(\.[a-zA-Z]{2,8})?$" title="example12@example.exapmle" required ><label for="email">Email</label></div><div class="information-name"><input id="regPassInp" type="text" spellcheck="false" pattern="^[A-Z]+(?=.*\d).{7,}" title="The password must start with one or more uppercase letters and must be at least 8 characters long. It must also include at least one digit." required><label for="password">Password</label></div></div><input type="submit" value="Sign Up"></form>');
        $('#signUpForm').submit(function () {
          let email = $("#regEmailInp").val();
          let password = $("#regPassInp").val();
          let name = $("#regNameInp").val();
          let currentDateTime = new Date();
          let formattedDateTime = currentDateTime.toISOString();

          User = {
            id: 0,
            name: name,
            email: email,
            password: password,
            regDate: formattedDateTime
          }
          ajaxCall("POST", baseApi + "/register", JSON.stringify(User), successCBLogin, errorCBLogin);

          return false;
        })
      });

      $('#loginLi').click(function () {
        if (localStorage["user"] != undefined) {
          $("#mainFormDiv").html("");
          $("#mainFormDiv").append('<h2 id="formHeader" >Are you sure you want to logout?</h2><button id="logoutBtn" class="btnbtn">Log Out</button>');
          $("#logoutBtn").click(() => {
            alert("loggedout");
            localStorage.removeItem("user");
            render();
            $("#HomeLi").click();
          })
        }
      });

      $('#loginLink').click(function () {
        if (localStorage["user"] != undefined) { //logOut
          localStorage.removeItem("user");
          alert("loggedOut");
        }
        $("#mainFormDiv").html("");
        $("#mainFormDiv").append('<h2 id="formHeader">Log in to enjoy your music</h2><form id="loginForm" class="work-request"><div id="formDiv" class="work-request--information"><div class="information-email"><input id="logEmailInp" type="email" spellcheck="false" pattern="^([a-zA-Z\d.-]+)@([a-zA-Z\d-]+)\.([a-zA-Z]{2,8})(\.[a-zA-Z]{2,8})?$" title="example12@example.exapmle" required><label for="email">Email</label></div><div class="information-name"><input id="logPassInp" type="text" spellcheck="false" pattern="^[A-Z]+(?=.*\d).{7,}" title="The password must start with one or more uppercase letters and must be at least 8 characters long. It must also include at least one digit." required><label for="password">password</label></div></div><input type="submit" value="Log In"></form>');
        render();
        $('#loginForm').submit(function () {
          let email = $("#logEmailInp").val();
          let password = $("#logPassInp").val();
          User = {
            id: 0,
            name: "string",
            email: email,
            password: password,
            regDate: "2023-06-10T12:33:08.383Z"
          }
          ajaxCall("POST", baseApi + "/login", JSON.stringify(User), successCBLogin, errorCBLogin);

          return false;
        })
      });

      function successCBLogin(data) {
        alert("signUp/login success")
        localStorage["user"] = JSON.stringify(data);
        $("#HomeLi").click();
        render();
      }
      function errorCBLogin(error) {
        let message = error.responseText;
        Swal.fire({
          icon: 'error',
          text: message,
        })
      }

    })

  </script>
 
</head>

<body>

  <!-- notification for small viewports and landscape oriented smartphones -->
  <div class="device-notification">
    <a class="device-notification--logo" href="#0">
      <img src="assets/img/logo.png" alt="Global">
      <p>SONGS</p>
    </a>
    <p class="device-notification--message">Global has so much to offer that we must request you orient your device to
      portrait or find a larger screen. You won't be disappointed.</p>
  </div>

  <div class="perspective effect-rotate-left">
    <div class="container">
      <div class="outer-nav--return"></div>
      <div id="viewport" class="l-viewport">
        <div class="l-wrapper">
          <header class="header">
            <a class="header--logo" href="#0">
              <img src="assets/img/logo.png" alt="Global">
              <p>SongsHive</p>
            </a>
            <button class="header--cta cta">Hello Ofek</button>
            <div class="header--nav-toggle">
              <span></span>
            </div>
          </header>
          <nav class="l-side-nav">
            <ul class="side-nav">
              <li id="HomeLi" class="is-active"><span>Home</span></li>
              <li><span>Songs</span></li>
              <li><span>Favorites</span></li>
              <li><span>Artists</span></li>
              <li><span>Quiz</span></li>
              <li id="loginLi"></li>
            </ul>
          </nav>
          <ul class="l-main-content main-content">
            <li class="l-section section section--is-active">
              <div class="intro">
                <div class="intro--banner">
                  <h1>Your next<br>interactive<br>experience</h1>
                  <button id="loginLink" class="cta">Login
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                      xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 150 118"
                      style="enable-background:new 0 0 150 118;" xml:space="preserve">
                      <g transform="translate(0.000000,118.000000) scale(0.100000,-0.100000)">
                        <path
                          d="M870,1167c-34-17-55-57-46-90c3-15,81-100,194-211l187-185l-565-1c-431,0-571-3-590-13c-55-28-64-94-18-137c21-20,33-20,597-20h575l-192-193C800,103,794,94,849,39c20-20,39-29,61-29c28,0,63,30,298,262c147,144,272,271,279,282c30,51,23,60-219,304C947,1180,926,1196,870,1167z" />
                      </g>
                    </svg>
                    <span class="btn-background"></span>
                  </button>
                  <br>
                  <span id="notMember">Not a Member? </span><button id="signUpLink" class="cta notMember"><u>Sign Up
                      Now</u></button>
                  <img src="assets/img/mainImage.png" alt="Welcome">
                </div>
                <div class="intro--options">
                  <a href="#0">
                    <h3 id="randTitle1"></h3>
                    <p id="randPara1"></p>
                  </a>
                  <a href="#0">
                    <h3 id="randTitle2"></h3>
                    <p id="randPara2"></p>
                  </a>
                  <a href="#0">
                    <h3 id="randTitle3"></h3>
                    <p id="randPara3"></p>
                  </a>
                </div>
              </div>
            </li>
            <li class="l-section section">
              <div class="work" id="search">
                <h2>Search Songs</h2>
                <form id="searchForm" class="work-request">
                  <div class="work-request--options">
                    <span class="options-a">
                      <input id="opt-1" type="checkbox" checked name="song-option" value="songName">
                      <label for="opt-1">
                        Song Name
                      </label>
                      <input id="opt-2" type="checkbox" name="song-option" value="artist">
                      <label for="opt-2">
                        Artist
                      </label>
                      <input id="opt-3" type="checkbox" name="song-option" value="lyrics">
                      <label for="opt-3">
                        Song Lyrics
                      </label>
                    </span>
                    </span>
                  </div>
                  <div class="work-request--information">
                    <div class="information-email">
                      <input type="text" id="searchInput" spellcheck="false">
                      <label for="text">search</label>
                    </div>
                    <input type="submit" id="searchBtn" value="Search">
                  </div>
                </form>
              </div>
              <div class="work" id="songs">

            </li>
            <li class="l-section section">
              <div class="about">
                <div class="about--banner">
                  <h2>We<br>believe in<br>passionate<br>people</h2>
                  <a href="#0">Career
                    <span>
                      <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 150 118"
                        style="enable-background:new 0 0 150 118;" xml:space="preserve">
                        <g transform="translate(0.000000,118.000000) scale(0.100000,-0.100000)">
                          <path
                            d="M870,1167c-34-17-55-57-46-90c3-15,81-100,194-211l187-185l-565-1c-431,0-571-3-590-13c-55-28-64-94-18-137c21-20,33-20,597-20h575l-192-193C800,103,794,94,849,39c20-20,39-29,61-29c28,0,63,30,298,262c147,144,272,271,279,282c30,51,23,60-219,304C947,1180,926,1196,870,1167z" />
                        </g>
                      </svg>
                    </span>
                  </a>
                  <img src="assets/img/about-visual.png" alt="About Us">
                </div>
                <div class="about--options">
                  <a href="#0">
                    <h3>Winners</h3>
                  </a>
                  <a href="#0">
                    <h3>Philosophy</h3>
                  </a>
                  <a href="#0">
                    <h3>History</h3>
                  </a>
                </div>
              </div>
            </li>
            <li class="l-section section">
              <div class="contact">
                <div class="contact--lockup">
                  <div class="modal">
                    <div class="modal--information">
                      <p>Pawia 5, 31-154 Kraków, Poland</p>
                      <a href="mailto:ouremail@gmail.com">ouremail@gmail.com</a>
                      <a href="tel:+148126287560">+48 12 628 75 60</a>
                    </div>
                    <ul class="modal--options">
                      <li><a href="#0">Bēhance</a></li>
                      <li><a href="#0">dribbble</a></li>
                      <li><a href="mailto:ouremail@gmail.com">Contact Us</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>
            <li class="l-section section">
              <div class="contact">
                <div class="contact--lockup">
                  <div class="modal">
                    <div class="modal--information">
                      <p>Pawia 5, 31-154 Kraków, Poland</p>
                      <a href="mailto:ouremail@gmail.com">ouremail@gmail.com</a>
                      <a href="tel:+148126287560">+48 12 628 75 60</a>
                    </div>
                    <ul class="modal--options">
                      <li><a href="#0">Bēhance</a></li>
                      <li><a href="#0">dribbble</a></li>
                      <li><a href="mailto:ouremail@gmail.com">Contact Us</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </li>
            <li class="l-section section">
              <div id="mainFormDiv" class="hire">
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <ul class="outer-nav">
      <li class="is-active">Home</li>
      <li>Songs</li>
      <li>Favorites</li>
      <li>Artists</li>
      <li>Quiz</li>
      <li id="outBarLogin">Login</li>
    </ul>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="assets/js/vendor/jquery-2.2.4.min.js"><\/script>')</script>
  <script src="assets/js/functions-min.js"></script>
  <script>
    const baseApiOfek = 'https://localhost:7091/api/'
    $(document).ready(() => {
      ajaxCall("GET", baseApiOfek + `Songs/randomSong`, "", successCBRandom1, errorCB);
      ajaxCall("GET", baseApiOfek + `Songs/randomSong`, "", successCBRandom2, errorCB);
      ajaxCall("GET", baseApiOfek + `Songs/randomSong`, "", successCBRandom3, errorCB);

      const checkboxes = document.querySelectorAll('input[type="checkbox"][name="song-option"]');

      // Add event listener to each checkbox
      checkboxes.forEach(function (checkbox) {
        checkbox.addEventListener('change', function () {
          // Uncheck all checkboxes except the current one
          checkboxes.forEach(function (cb) {
            if (cb !== checkbox) {
              cb.checked = false;
            }
          });
        });
      });
      $()
      $("#searchForm").submit(() => {
        const checkedValue = document.querySelector('input[name="song-option"]:checked').value;
        let serachApi;
        let userInput = $('#searchInput').val();
        switch (checkedValue) {
          case "songName":
            serachApi = baseApiOfek + `Songs/${userInput}/info`
            break;
          case "artist":
            serachApi = baseApiOfek + `Artists/${userInput}/songs`
            break;
          case "lyrics":
            serachApi = baseApiOfek + `Songs/songBylyrics?lyrics=${userInput}`
            break;
          default: return false;
        }
        ajaxCall("GET", serachApi, "", successCBSong, errorCB);
        return false;
      })

    })

    function successCBSong(data) {
      console.log(data)
      $("#songs").html("")
      console.log(data.length)
      if (data.length === undefined) {
        $("#songs").append(`<h2>Results:</h2>
                  <div class="work--lockup">
                    <ul class="slider">
                      <li class="slider--item slider--item-center">
                        <a href="#0">
                          <div class="slider--item-image">
                            <img src="assets/img/work-metiew-smith.jpg" alt="Metiew and Smith">
                          </div>
                          <p class="slider--item-title">${data.name}</p>
                          <p class="slider--item-description">${data.artistName}</p>
                        </a>
                      </li>
                    </ul>
                  </div>`)
      }
      else {
        let restOfSongs = "";
        restOfSongs += `<h2>Results:</h2>
           <div class="work--lockup">
            <ul class="slider">
            <li class="slider--item slider--item-left">
            <a href="#0">
            <div class="slider--item-image">
            <img src="assets/img/work-victory.jpg" alt="Victory">
            </div>
            <p class="slider--item-title">${data[0].name}</p>
            <p class="slider--item-description">${data[0].artistName}</p>
            </a>
            </li>
            <li class="slider--item slider--item-center">
            <a href="#0">
            <div class="slider--item-image">
            <img src="assets/img/work-metiew-smith.jpg" alt="Metiew and Smith">
            </div>
            <p class="slider--item-title">${data[1].name}</p>
            <p class="slider--item-description">${data[1].artistName}</p>
            </a>
            </li>
            <li class="slider--item slider--item-right">
            <a href="#0">
            <div class="slider--item-image">
            <img src="assets/img/work-alex-nowak.jpg" alt="Alex Nowak">
            </div>
            <p class="slider--item-title">${data[2].name}</p>
            <p class="slider--item-description">${data[2].artistName}</p>
            </a>
            </li>`
        for (let i = 3; i < data.length - 3; i++) {
          restOfSongs += ` <li class="slider--item">
             <a href="#0">
             <div class="slider--item-image">
             <img src="assets/img/work-alex-nowak.jpg" alt="Alex Nowak">
             </div>
             <p class="slider--item-title">${data[i].name}</p>
             <p class="slider--item-description">${data[i].artistName}</p>
             </a>
             </li>`
        }
        restOfSongs += `</ul>
        <div class="slider--prev">
          <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 150 118"
                        style="enable-background:new 0 0 150 118;" xml:space="preserve">
                        <g transform="translate(0.000000,118.000000) scale(0.100000,-0.100000)">
                          <path d="M561,1169C525,1155,10,640,3,612c-3-13,1-36,8-52c8-15,134-145,281-289C527,41,562,10,590,10c22,0,41,9,61,29
                      c55,55,49,64-163,278L296,510h575c564,0,576,0,597,20c46,43,37,109-18,137c-19,10-159,13-590,13l-565,1l182,180
                      c101,99,187,188,193,199c16,30,12,57-12,84C631,1174,595,1183,561,1169z" />
                        </g></svg></div>
                        <div class="slider--next"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 150 118"
                        style="enable-background:new 0 0 150 118;" xml:space="preserve">
                        <g transform="translate(0.000000,118.000000) scale(0.100000,-0.100000)">
                          <path d="M870,1167c-34-17-55-57-46-90c3-15,81-100,194-211l187-185l-565-1c-431,0-571-3-590-13c-55-28-64-94-18-137c21-20,33-20,597-20h575l-192-193C800,103,794,94,849,39c20-20,39-29,61-29c28,0,63,30,298,262c147,144,272,271,279,282c30,51,23,60-219,304C947,1180,926,1196,870,1167z" />
                        </g></svg></div></div>`
        $("#songs").append(restOfSongs);
        workSlider()
      }
    }
    function workSlider() {

      $('.slider--prev, .slider--next').click(function () {

        var $this = $(this),
          curLeft = $('.slider').find('.slider--item-left'),
          curLeftPos = $('.slider').children().index(curLeft),
          curCenter = $('.slider').find('.slider--item-center'),
          curCenterPos = $('.slider').children().index(curCenter),
          curRight = $('.slider').find('.slider--item-right'),
          curRightPos = $('.slider').children().index(curRight),
          totalWorks = $('.slider').children().length,
          $left = $('.slider--item-left'),
          $center = $('.slider--item-center'),
          $right = $('.slider--item-right'),
          $item = $('.slider--item');
        console.log("works:" + totalWorks)
        $('.slider').animate({ opacity: 0 }, 400);

        setTimeout(function () {

          if ($this.hasClass('slider--next')) {
            if (curLeftPos < totalWorks - 1 && curCenterPos < totalWorks - 1 && curRightPos < totalWorks - 1) {
              $left.removeClass('slider--item-left').next().addClass('slider--item-left');
              $center.removeClass('slider--item-center').next().addClass('slider--item-center');
              $right.removeClass('slider--item-right').next().addClass('slider--item-right');
            }
            else {
              if (curLeftPos === totalWorks - 1) {
                $item.removeClass('slider--item-left').first().addClass('slider--item-left');
                $center.removeClass('slider--item-center').next().addClass('slider--item-center');
                $right.removeClass('slider--item-right').next().addClass('slider--item-right');
              }
              else if (curCenterPos === totalWorks - 1) {
                $left.removeClass('slider--item-left').next().addClass('slider--item-left');
                $item.removeClass('slider--item-center').first().addClass('slider--item-center');
                $right.removeClass('slider--item-right').next().addClass('slider--item-right');
              }
              else {
                $left.removeClass('slider--item-left').next().addClass('slider--item-left');
                $center.removeClass('slider--item-center').next().addClass('slider--item-center');
                $item.removeClass('slider--item-right').first().addClass('slider--item-right');
              }
            }
          }
          else {
            if (curLeftPos !== 0 && curCenterPos !== 0 && curRightPos !== 0) {
              $left.removeClass('slider--item-left').prev().addClass('slider--item-left');
              $center.removeClass('slider--item-center').prev().addClass('slider--item-center');
              $right.removeClass('slider--item-right').prev().addClass('slider--item-right');
            }
            else {
              if (curLeftPos === 0) {
                $item.removeClass('slider--item-left').last().addClass('slider--item-left');
                $center.removeClass('slider--item-center').prev().addClass('slider--item-center');
                $right.removeClass('slider--item-right').prev().addClass('slider--item-right');
              }
              else if (curCenterPos === 0) {
                $left.removeClass('slider--item-left').prev().addClass('slider--item-left');
                $item.removeClass('slider--item-center').last().addClass('slider--item-center');
                $right.removeClass('slider--item-right').prev().addClass('slider--item-right');
              }
              else {
                $left.removeClass('slider--item-left').prev().addClass('slider--item-left');
                $center.removeClass('slider--item-center').prev().addClass('slider--item-center');
                $item.removeClass('slider--item-right').last().addClass('slider--item-right');
              }
            }
          }

        }, 400);

        $('.slider').animate({ opacity: 1 }, 400);

      });

    }
    function successCBRandom1(data) {
      $(`#randTitle1`).html(data.name)
      $(`#randPara1`).html(data.artistName)
    }
    function successCBRandom2(data) {
      $(`#randTitle2`).html(data.name)
      $(`#randPara2`).html(data.artistName)
    }
    function successCBRandom3(data) {
      $(`#randTitle3`).html(data.name)
      $(`#randPara3`).html(data.artistName)
    }

    function errorCB(data) {
      console.log(data);
    }
  </script>
</body>

</html>